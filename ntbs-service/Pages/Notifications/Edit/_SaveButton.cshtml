@using ntbs_service.Helpers
@using ntbs_service.Models
@using ntbs_service.Models.Enums
@model ntbs_service.Models.Entities.Notification

@{
    var isDraft = Model.NotificationStatus == NotificationStatus.Draft;
    var pageHasEditableContent = (bool?) ViewData["PageHasEditableContent"] ?? true;
    var currentPage = (string) ViewData["CurrentPage"];
    var isEditMDRPage = currentPage == NotificationSubPaths.EditMDRDetails;
    var isEditTreatmentEventsPage = currentPage == NotificationSubPaths.EditTreatmentEvents;

    var buttonName = "";
    if (isEditMDRPage && isDraft)
    {
        buttonName = "Save";
    }
    else if (!pageHasEditableContent)
    {
        buttonName = "Continue";
    }
    else buttonName = isDraft ? "Save and continue" : "Save";

    var id = ViewData.ContainsKey("id") ? ViewData["id"] : "save-button";
}

@if (isDraft && isEditTreatmentEventsPage & !Model.IsMdr)
{
    return;
}

@if (isDraft || pageHasEditableContent)
{
    <button
        nhs-button-type="Standard"
        classes="ntbsuk-button--primary"
        name="actionName"
        value="@ActionNameString.Save"
        id="@id">
        @buttonName
    </button>
}

@if (!isDraft)
{
    <nhs-back-link data-ignore-form-leave-checker="true" href="@RouteHelper.GetNotificationOverviewPathWithSectionAnchor(Model.NotificationId, currentPage)">Cancel & go back</nhs-back-link>
}